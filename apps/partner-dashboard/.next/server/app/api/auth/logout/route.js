"use strict";(()=>{var e={};e.id=716,e.ids=[716],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78123:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>x,requestAsyncStorage:()=>h,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f});var a={};r.r(a),r.d(a,{POST:()=>p});var n=r(49303),o=r(88716),i=r(60670),s=r(71615),u=r(87070),c=r(95456);let l=process.env.API_URL||"http://localhost:3000";async function p(){let e=await (0,s.cookies)(),t=e.get(c.wr)?.value,r=e.get(c.dj)?.value;if(r)try{await fetch(`${l}/api/v1/auth/logout`,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},body:JSON.stringify({refreshToken:r})})}catch{}return(0,c.Wx)(e),u.NextResponse.json({success:!0})}let d=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/logout/route",pathname:"/api/auth/logout",filename:"route",bundlePath:"app/api/auth/logout/route"},resolvedPagePath:"/Users/pacomedomagni/Projects/havenkeep/apps/partner-dashboard/src/app/api/auth/logout/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:f,serverHooks:g}=d,m="/api/auth/logout/route";function x(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}},95456:(e,t,r)=>{r.d(t,{D6:()=>g,Wx:()=>f,dj:()=>s,kF:()=>h,lz:()=>l,pw:()=>c,wr:()=>i});var a=r(71615),n=r(58585);let o=process.env.API_URL||"http://localhost:3000",i="hk_access_token",s="hk_refresh_token";function u(e){try{let t=e.split(".");if(3!==t.length)return null;return JSON.parse(Buffer.from(t[1],"base64url").toString())}catch{return null}}function c(e){let t=u(e);return!t||1e3*t.exp<Date.now()}async function l(){let e=await (0,a.cookies)(),t=e.get(i)?.value,r=e.get(s)?.value;return t&&r?{accessToken:t,refreshToken:r}:null}async function p(){let e=await l();if(!e)return null;let t=u(e.accessToken);if(!t)return null;try{let t=await fetch(`${o}/api/v1/admin/me`,{headers:{Authorization:`Bearer ${e.accessToken}`,"Content-Type":"application/json"},cache:"no-store"});if(t.ok){let e=await t.json();return{id:e.user.id,email:e.user.email,plan:e.user.plan,isAdmin:e.user.isAdmin,isPartner:e.user.isPartner??!1}}}catch{}return{id:t.userId,email:t.email,plan:"free",isAdmin:!1,isPartner:!1}}async function d(){let e=await p();return e||(0,n.redirect)("/login"),e}async function h(){let e=await d();return e.isAdmin||(0,n.redirect)("/unauthorized"),e}function f(e){e.delete(i),e.delete(s)}async function g(e,t={}){let r=await l(),{method:a="GET",body:n,headers:i={}}=t,s={method:a,headers:{"Content-Type":"application/json",...r?{Authorization:`Bearer ${r.accessToken}`}:{},...i},cache:"no-store"};n&&"GET"!==a&&(s.body=JSON.stringify(n));let u=`${o}${e}`,c=await fetch(u,s);if(!c.ok){let e=await c.json().catch(()=>({}));throw Error(e.message||e.error||`API request failed with status ${c.status}`)}return c.json()}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,54,972],()=>r(78123));module.exports=a})();