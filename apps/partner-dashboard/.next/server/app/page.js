(()=>{var e={};e.id=931,e.ids=[931],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},76729:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c}),r(35480),r(32029),r(35866);var n=r(23191),a=r(88716),s=r(37922),i=r.n(s),o=r(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,35480)),"/Users/pacomedomagni/Projects/havenkeep/apps/partner-dashboard/src/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,32029)),"/Users/pacomedomagni/Projects/havenkeep/apps/partner-dashboard/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/pacomedomagni/Projects/havenkeep/apps/partner-dashboard/src/app/page.tsx"],u="/page",p={require:r,loadChunk:()=>Promise.resolve()},h=new n.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},73575:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,12994,23)),Promise.resolve().then(r.t.bind(r,96114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,79671,23)),Promise.resolve().then(r.t.bind(r,41868,23)),Promise.resolve().then(r.t.bind(r,84759,23))},65360:()=>{},35303:()=>{},32029:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>i});var n=r(19510),a=r(45317),s=r.n(a);r(5023);let i={title:"HavenKeep Admin",description:"Admin dashboard for HavenKeep",icons:{icon:"/favicon.svg"}};function o({children:e}){return n.jsx("html",{lang:"en",children:n.jsx("body",{className:s().className,children:e})})}},35480:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var n=r(58585),a=r(95456);async function s(){let e=await (0,a.lz)();e&&!(0,a.pw)(e.accessToken)?(0,n.redirect)("/dashboard"):(0,n.redirect)("/login")}},95456:(e,t,r)=>{"use strict";r.d(t,{D6:()=>f,Wx:()=>m,dj:()=>o,kF:()=>h,lz:()=>d,pw:()=>c,wr:()=>i});var n=r(71615),a=r(58585);let s=process.env.API_URL||"http://localhost:3000",i="hk_access_token",o="hk_refresh_token";function l(e){try{let t=e.split(".");if(3!==t.length)return null;return JSON.parse(Buffer.from(t[1],"base64url").toString())}catch{return null}}function c(e){let t=l(e);return!t||1e3*t.exp<Date.now()}async function d(){let e=await (0,n.cookies)(),t=e.get(i)?.value,r=e.get(o)?.value;return t&&r?{accessToken:t,refreshToken:r}:null}async function u(){let e=await d();if(!e)return null;let t=l(e.accessToken);if(!t)return null;try{let t=await fetch(`${s}/api/v1/admin/me`,{headers:{Authorization:`Bearer ${e.accessToken}`,"Content-Type":"application/json"},cache:"no-store"});if(t.ok){let e=await t.json();return{id:e.user.id,email:e.user.email,plan:e.user.plan,isAdmin:e.user.isAdmin,isPartner:e.user.isPartner??!1}}}catch{}return{id:t.userId,email:t.email,plan:"free",isAdmin:!1,isPartner:!1}}async function p(){let e=await u();return e||(0,a.redirect)("/login"),e}async function h(){let e=await p();return e.isAdmin||(0,a.redirect)("/unauthorized"),e}function m(e){e.delete(i),e.delete(o)}async function f(e,t={}){let r=await d(),{method:n="GET",body:a,headers:i={}}=t,o={method:n,headers:{"Content-Type":"application/json",...r?{Authorization:`Bearer ${r.accessToken}`}:{},...i},cache:"no-store"};a&&"GET"!==n&&(o.body=JSON.stringify(a));let l=`${s}${e}`,c=await fetch(l,o);if(!c.ok){let e=await c.json().catch(()=>({}));throw Error(e.message||e.error||`API request failed with status ${c.status}`)}return c.json()}},5023:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,347,54],()=>r(76729));module.exports=n})();