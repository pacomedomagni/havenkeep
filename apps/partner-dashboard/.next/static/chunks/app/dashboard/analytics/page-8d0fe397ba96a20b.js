(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[171],{93798:function(e,t,n){Promise.resolve().then(n.bind(n,5782))},40257:function(e,t,n){"use strict";var r,s;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(44227)},44227:function(e){!function(){var t={229:function(e){var t,n,r,s=e.exports={};function a(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var c=[],l=!1,d=-1;function u(){l&&r&&(l=!1,r.length?c=r.concat(c):d=-1,c.length&&h())}function h(){if(!l){var e=o(u);l=!0;for(var t=c.length;t;){for(r=c,c=[];++d<t;)r&&r[d].run();d=-1,t=c.length}r=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function x(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new x(e,t)),1!==c.length||l||o(h)},x.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var a=n[e]={exports:{}},i=!0;try{t[e](a,a.exports,r),i=!1}finally{i&&delete n[e]}return a.exports}r.ab="//";var s=r(229);e.exports=s}()},5782:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var r=n(57437),s=n(2265),a=n(47625),i=n(77031),o=n(56940),c=n(97059),l=n(62994),d=n(8147),u=n(31699),h=n(20407);let x=[{stage:"Gifts Sent",count:0,color:"#6C63FF"},{stage:"Activated",count:0,color:"#BB86FC"},{stage:"Active Users",count:0,color:"#4CAF50"},{stage:"Premium",count:0,color:"#FFC107"}];function m(e){let{data:t}=e,n=t&&t.length>0?t:x;return(0,r.jsx)(a.h,{width:"100%",height:300,children:(0,r.jsxs)(i.v,{data:n,margin:{top:5,right:20,left:0,bottom:5},children:[(0,r.jsx)(o.q,{strokeDasharray:"3 3",stroke:"#2A2A2A"}),(0,r.jsx)(c.K,{dataKey:"stage",stroke:"#707070",fontSize:12,tickLine:!1,axisLine:{stroke:"#2A2A2A"}}),(0,r.jsx)(l.B,{stroke:"#707070",fontSize:12,tickLine:!1,axisLine:{stroke:"#2A2A2A"},allowDecimals:!1}),(0,r.jsx)(d.u,{contentStyle:{backgroundColor:"#1E1E1E",border:"1px solid #2A2A2A",borderRadius:"8px",color:"#FFFFFF"},labelStyle:{color:"#B0B0B0"}}),(0,r.jsx)(u.$,{dataKey:"count",radius:[6,6,0,0],children:n.map((e,t)=>(0,r.jsx)(h.b,{fill:e.color},"cell-".concat(t)))})]})})}var f=n(71837);function v(){let[e,t]=(0,s.useState)(null),[n,a]=(0,s.useState)(!0),[i,o]=(0,s.useState)(null);(0,s.useEffect)(()=>{c()},[]);let c=async()=>{try{o(null);let e=await (0,f.x1)("/api/v1/partners/analytics");e.success&&e.data&&t(e.data)}catch(e){o("Failed to load analytics data."),console.error("Error fetching analytics:",e)}finally{a(!1)}};if(n)return(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-haven-primary"})});let l=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Analytics"}),(0,r.jsx)("p",{className:"text-haven-text-secondary text-sm mt-1",children:"Deep dive into your referral performance and earnings"})]}),i&&(0,r.jsxs)("div",{className:"bg-haven-error/10 border border-haven-error/30 rounded-lg p-4 text-haven-error text-sm",children:[i,(0,r.jsx)("button",{onClick:c,className:"ml-2 underline",children:"Retry"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Conversion Funnel"}),(0,r.jsx)("p",{className:"text-sm text-haven-text-secondary mb-4",children:"Track how referrals convert through each stage"}),(0,r.jsx)(m,{data:e?[{stage:"Total Gifts",count:e.total_gifts,color:"#6C63FF"},{stage:"Pending",count:e.pending_gifts,color:"#BB86FC"},{stage:"Activated",count:e.activated_gifts,color:"#4CAF50"}]:void 0})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Commissions Breakdown"}),(0,r.jsx)("p",{className:"text-sm text-haven-text-secondary mb-4",children:"Your commission earnings summary"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border border-haven-border rounded-lg",children:[(0,r.jsx)("span",{className:"text-haven-text-secondary",children:"Total Earned"}),(0,r.jsx)("span",{className:"text-lg font-bold text-white",children:l((null==e?void 0:e.total_commissions)||0)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border border-haven-border rounded-lg",children:[(0,r.jsx)("span",{className:"text-haven-text-secondary",children:"Paid Out"}),(0,r.jsx)("span",{className:"text-lg font-bold text-haven-active",children:l((null==e?void 0:e.paid_commissions)||0)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border border-haven-border rounded-lg",children:[(0,r.jsx)("span",{className:"text-haven-text-secondary",children:"Pending"}),(0,r.jsx)("span",{className:"text-lg font-bold text-haven-warning",children:l((null==e?void 0:e.pending_commissions)||0)})]})]})]}),(0,r.jsxs)("div",{className:"card lg:col-span-2",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Performance Summary"}),(0,r.jsx)("p",{className:"text-sm text-haven-text-secondary mb-4",children:"Key metrics for your partner activity"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"text-center p-4 border border-haven-border rounded-lg",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-haven-primary",children:(null==e?void 0:e.total_gifts)||0}),(0,r.jsx)("div",{className:"text-sm text-haven-text-secondary mt-1",children:"Total Gifts Sent"})]}),(0,r.jsxs)("div",{className:"text-center p-4 border border-haven-border rounded-lg",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-haven-active",children:(null==e?void 0:e.activated_gifts)||0}),(0,r.jsx)("div",{className:"text-sm text-haven-text-secondary mt-1",children:"Gifts Activated"})]}),(0,r.jsxs)("div",{className:"text-center p-4 border border-haven-border rounded-lg",children:[(0,r.jsxs)("div",{className:"text-3xl font-bold text-haven-warning",children:[(null==e?void 0:e.activation_rate)||0,"%"]}),(0,r.jsx)("div",{className:"text-sm text-haven-text-secondary mt-1",children:"Activation Rate"})]})]})]})]})]})}},71837:function(e,t,n){"use strict";n.d(t,{kS:function(){return i},x1:function(){return s}});let r=n(40257).env.NEXT_PUBLIC_API_URL||"";async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:n="GET",body:s,headers:i={}}=t,o={method:n,credentials:"include",headers:{"Content-Type":"application/json",...i}};s&&"GET"!==n&&(o.body=JSON.stringify(s));let c=e.startsWith("http")?e:"".concat(r).concat(e),l=await fetch(c,o);if(!l.ok){let e=await l.json().catch(()=>({}));throw new a(e.message||e.error||"Request failed with status ".concat(l.status),l.status)}return l.json()}class a extends Error{constructor(e,t){super(e),this.status=t,this.name="ApiError"}}async function i(){await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),window.location.href="/login"}}},function(e){e.O(0,[447,971,117,744],function(){return e(e.s=93798)}),_N_E=e.O()}]);