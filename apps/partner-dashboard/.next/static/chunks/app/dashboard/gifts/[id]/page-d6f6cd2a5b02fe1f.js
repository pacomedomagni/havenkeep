(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[901],{1074:function(e,t,s){Promise.resolve().then(s.bind(s,37290))},99376:function(e,t,s){"use strict";var a=s(35475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},40257:function(e,t,s){"use strict";var a,n;e.exports=(null==(a=s.g.process)?void 0:a.env)&&"object"==typeof(null==(n=s.g.process)?void 0:n.env)?s.g.process:s(44227)},44227:function(e){!function(){var t={229:function(e){var t,s,a,n=e.exports={};function i(){throw Error("setTimeout has not been defined")}function r(){throw Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{s="function"==typeof clearTimeout?clearTimeout:r}catch(e){s=r}}();var l=[],o=!1,d=-1;function m(){o&&a&&(o=!1,a.length?l=a.concat(l):d=-1,l.length&&h())}function h(){if(!o){var e=c(m);o=!0;for(var t=l.length;t;){for(a=l,l=[];++d<t;)a&&a[d].run();d=-1,t=l.length}a=null,o=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===r||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function x(e,t){this.fun=e,this.array=t}function u(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];l.push(new x(e,t)),1!==l.length||o||c(h)},x.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=u,n.addListener=u,n.once=u,n.off=u,n.removeListener=u,n.removeAllListeners=u,n.emit=u,n.prependListener=u,n.prependOnceListener=u,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},s={};function a(e){var n=s[e];if(void 0!==n)return n.exports;var i=s[e]={exports:{}},r=!0;try{t[e](i,i.exports,a),r=!1}finally{r&&delete s[e]}return i.exports}a.ab="//";var n=a(229);e.exports=n}()},37290:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(57437),n=s(2265),i=s(99376),r=s(71837);function c(){var e;let t=(0,i.useRouter)(),s=(0,i.useParams)().id,[c,l]=(0,n.useState)(null),[o,d]=(0,n.useState)(!0),[m,h]=(0,n.useState)(""),[x,u]=(0,n.useState)(!1),[f,v]=(0,n.useState)(!1),[p,b]=(0,n.useState)(!1);(0,n.useEffect)(()=>{j()},[s]);let j=async()=>{try{let e=await (0,r.x1)("/api/v1/partners/gifts/".concat(s));e.success&&e.data?l(e.data):h(e.message||"Failed to load gift")}catch(e){h(e.message||"An error occurred while loading the gift")}finally{d(!1)}},g=async()=>{try{let e=await (0,r.x1)("/api/v1/partners/gifts/".concat(s,"/resend"),{method:"POST"});e.success?u(!1):h(e.message||"Failed to resend email")}catch(e){h(e.message||"An error occurred. Please try again.")}},N=(e,t)=>{navigator.clipboard.writeText(e),"code"===t?(v(!0),setTimeout(()=>v(!1),2e3)):(b(!0),setTimeout(()=>b(!1),2e3))};return o?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-haven-primary"})}):m||!c?(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"bg-haven-error/10 border border-haven-error/30 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-haven-error",children:m||"Gift not found"}),(0,a.jsx)("button",{onClick:()=>t.push("/dashboard/gifts"),className:"mt-4 text-haven-primary hover:text-haven-primary/80",children:"Back to Gifts"})]})}):(0,a.jsxs)("div",{className:"space-y-6 max-w-5xl",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>t.push("/dashboard/gifts"),className:"text-haven-primary hover:text-haven-primary/80 mb-4 flex items-center gap-2 text-sm",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Gifts"]}),(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Gift Details"}),(0,a.jsxs)("p",{className:"text-haven-text-secondary text-sm mt-1",children:["Created ",new Date(c.created_at).toLocaleDateString()]})]}),(e=c.status,c.is_activated?(0,a.jsx)("span",{className:"badge-converted",children:"Activated"}):(0,a.jsx)("span",{className:{created:"badge-approved",sent:"badge-pending",expired:"badge-expired"}[e]||"badge-pending",children:e.charAt(0).toUpperCase()+e.slice(1)}))]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Homebuyer Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-haven-text-tertiary mb-1",children:"Name"}),(0,a.jsx)("p",{className:"text-white",children:c.homebuyer_name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-haven-text-tertiary mb-1",children:"Email"}),(0,a.jsx)("p",{className:"text-white",children:c.homebuyer_email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-haven-text-tertiary mb-1",children:"Phone"}),(0,a.jsx)("p",{className:"text-white",children:c.homebuyer_phone||"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-haven-text-tertiary mb-1",children:"Closing Date"}),(0,a.jsx)("p",{className:"text-white",children:c.closing_date?new Date(c.closing_date).toLocaleDateString():"—"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-haven-text-tertiary mb-1",children:"Home Address"}),(0,a.jsx)("p",{className:"text-white",children:c.home_address||"—"})]})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Gift Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-haven-text-tertiary mb-1",children:"Premium Duration"}),(0,a.jsxs)("p",{className:"text-white text-2xl font-bold",children:[c.premium_months," months"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-haven-text-tertiary mb-1",children:"Amount Charged"}),(0,a.jsxs)("p",{className:"text-white text-2xl font-bold",children:["$",c.amount_charged.toFixed(2)]})]}),c.custom_message&&(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-haven-text-tertiary mb-1",children:"Custom Message"}),(0,a.jsx)("p",{className:"text-haven-text-secondary bg-haven-elevated p-3 rounded-lg border border-haven-border",children:c.custom_message})]})]})]}),c.is_activated&&c.activated_at&&(0,a.jsxs)("div",{className:"bg-haven-active/10 border border-haven-active/30 rounded-xl p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("svg",{className:"w-6 h-6 text-haven-active",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-haven-active",children:"Gift Activated!"})]}),(0,a.jsxs)("p",{className:"text-haven-text-secondary",children:["This gift was activated on ",new Date(c.activated_at).toLocaleDateString()," at"," ",new Date(c.activated_at).toLocaleTimeString()]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[!c.is_activated&&c.activation_code&&(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Activation Details"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-haven-text-tertiary mb-2",children:"Activation Code"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:c.activation_code,readOnly:!0,className:"input-field flex-1 font-mono text-sm"}),(0,a.jsx)("button",{onClick:()=>N(c.activation_code,"code"),className:"btn-primary px-3",children:f?"Copied":"Copy"})]})]}),c.activation_url&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-haven-text-tertiary mb-2",children:"Activation URL"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:c.activation_url,readOnly:!0,className:"input-field flex-1 text-xs"}),(0,a.jsx)("button",{onClick:()=>N(c.activation_url,"url"),className:"btn-primary px-3",children:p?"Copied":"Copy"})]})]}),(0,a.jsx)("button",{onClick:()=>u(!0),className:"btn-secondary w-full",children:"Resend Gift Email"})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Stats"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-haven-text-tertiary",children:"Status"}),(0,a.jsx)("span",{className:"text-sm font-medium text-white capitalize",children:c.status})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-haven-text-tertiary",children:"Amount Charged"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-white",children:["$",c.amount_charged.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-haven-text-tertiary",children:"Days Since Created"}),(0,a.jsx)("span",{className:"text-sm font-medium text-white",children:Math.max(0,Math.floor((Date.now()-new Date(c.created_at).getTime())/864e5))})]})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Actions"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("button",{onClick:()=>window.open("mailto:".concat(c.homebuyer_email),"_blank"),className:"btn-secondary w-full flex items-center justify-center gap-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email Homebuyer"]}),c.homebuyer_phone&&(0,a.jsxs)("button",{onClick:()=>window.open("tel:".concat(c.homebuyer_phone),"_blank"),className:"btn-secondary w-full flex items-center justify-center gap-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Call Homebuyer"]})]})]})]})]}),x&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-haven-surface border border-haven-border rounded-xl p-6 max-w-md w-full mx-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Resend Gift Email"}),(0,a.jsxs)("p",{className:"text-haven-text-secondary mb-6",children:["Are you sure you want to resend the gift activation email to"," ",(0,a.jsx)("strong",{className:"text-white",children:c.homebuyer_email}),"?"]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>u(!1),className:"btn-secondary flex-1",children:"Cancel"}),(0,a.jsx)("button",{onClick:g,className:"btn-primary flex-1",children:"Resend Email"})]})]})})]})}},71837:function(e,t,s){"use strict";s.d(t,{kS:function(){return r},x1:function(){return n}});let a=s(40257).env.NEXT_PUBLIC_API_URL||"";async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:s="GET",body:n,headers:r={}}=t,c={method:s,credentials:"include",headers:{"Content-Type":"application/json",...r}};n&&"GET"!==s&&(c.body=JSON.stringify(n));let l=e.startsWith("http")?e:"".concat(a).concat(e),o=await fetch(l,c);if(!o.ok){let e=await o.json().catch(()=>({}));throw new i(e.message||e.error||"Request failed with status ".concat(o.status),o.status)}return o.json()}class i extends Error{constructor(e,t){super(e),this.status=t,this.name="ApiError"}}async function r(){await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),window.location.href="/login"}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=1074)}),_N_E=e.O()}]);