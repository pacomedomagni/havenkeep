(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[546],{60237:function(e,t,s){Promise.resolve().then(s.bind(s,42029))},99376:function(e,t,s){"use strict";var r=s(35475);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},40257:function(e,t,s){"use strict";var r,a;e.exports=(null==(r=s.g.process)?void 0:r.env)&&"object"==typeof(null==(a=s.g.process)?void 0:a.env)?s.g.process:s(44227)},44227:function(e){!function(){var t={229:function(e){var t,s,r,a=e.exports={};function n(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:n}catch(e){t=n}try{s="function"==typeof clearTimeout?clearTimeout:i}catch(e){s=i}}();var l=[],c=!1,d=-1;function u(){c&&r&&(c=!1,r.length?l=r.concat(l):d=-1,l.length&&h())}function h(){if(!c){var e=o(u);c=!0;for(var t=l.length;t;){for(r=l,l=[];++d<t;)r&&r[d].run();d=-1,t=l.length}r=null,c=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===i||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function x(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];l.push(new m(e,t)),1!==l.length||c||o(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=x,a.addListener=x,a.once=x,a.off=x,a.removeListener=x,a.removeAllListeners=x,a.emit=x,a.prependListener=x,a.prependOnceListener=x,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},s={};function r(e){var a=s[e];if(void 0!==a)return a.exports;var n=s[e]={exports:{}},i=!0;try{t[e](n,n.exports,r),i=!1}finally{i&&delete s[e]}return n.exports}r.ab="//";var a=r(229);e.exports=a}()},42029:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var r=s(57437),a=s(2265),n=s(99376),i=s(71837);function o(){let e=(0,n.useRouter)(),[t,s]=(0,a.useState)([]),[o,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(null),[h,m]=(0,a.useState)("all"),[x,p]=(0,a.useState)(!1);(0,a.useEffect)(()=>{f()},[h]);let f=async()=>{try{u(null);let e="all"===h?"/api/v1/partners/gifts":"/api/v1/partners/gifts?status=".concat(h),t=await (0,i.x1)(e);t.success&&t.data&&s(t.data)}catch(e){u("Failed to load gifts."),console.error("Error fetching gifts:",e)}finally{c(!1)}},v=(e,t)=>t?(0,r.jsx)("span",{className:"badge-converted",children:"Activated"}):(0,r.jsx)("span",{className:{created:"badge-approved",sent:"badge-pending",expired:"badge-expired"}[e]||"badge-pending",children:e.charAt(0).toUpperCase()+e.slice(1)});return o?(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-haven-primary"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Closing Gifts"}),(0,r.jsx)("p",{className:"text-haven-text-secondary text-sm mt-1",children:"Manage gifts for your homebuyers"})]}),(0,r.jsxs)("button",{onClick:()=>p(!0),className:"btn-primary inline-flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create New Gift"]})]}),d&&(0,r.jsxs)("div",{className:"bg-haven-error/10 border border-haven-error/30 rounded-lg p-4 text-haven-error text-sm",children:[d,(0,r.jsx)("button",{onClick:f,className:"ml-2 underline",children:"Retry"})]}),(0,r.jsx)("div",{className:"flex gap-2",children:["all","created","activated","expired"].map(e=>(0,r.jsx)("button",{onClick:()=>m(e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 ".concat(h===e?"bg-haven-primary text-white":"bg-haven-surface text-haven-text-secondary hover:bg-haven-elevated hover:text-white border border-haven-border"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),0===t.length?(0,r.jsxs)("div",{className:"card text-center py-12",children:[(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-haven-text-tertiary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-white",children:"No gifts"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-haven-text-tertiary",children:"Get started by creating a new closing gift."}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)("button",{onClick:()=>p(!0),className:"btn-primary",children:"Create Gift"})})]}):(0,r.jsx)("div",{className:"card p-0 overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-haven-border",children:[(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-haven-text-tertiary uppercase tracking-wider",children:"Homebuyer"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-haven-text-tertiary uppercase tracking-wider",children:"Address"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-haven-text-tertiary uppercase tracking-wider",children:"Closing Date"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-haven-text-tertiary uppercase tracking-wider",children:"Premium"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-haven-text-tertiary uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"text-right py-3 px-4 text-xs font-medium text-haven-text-tertiary uppercase tracking-wider",children:"Cost"}),(0,r.jsx)("th",{className:"text-right py-3 px-4 text-xs font-medium text-haven-text-tertiary uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-haven-border",children:t.map(t=>(0,r.jsxs)("tr",{className:"hover:bg-haven-elevated/50 transition-colors",children:[(0,r.jsxs)("td",{className:"py-3 px-4",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-white",children:t.homebuyer_name}),(0,r.jsx)("div",{className:"text-xs text-haven-text-tertiary",children:t.homebuyer_email})]}),(0,r.jsx)("td",{className:"py-3 px-4 text-sm text-haven-text-secondary",children:t.home_address||"—"}),(0,r.jsx)("td",{className:"py-3 px-4 text-sm text-haven-text-secondary",children:t.closing_date?new Date(t.closing_date).toLocaleDateString():"—"}),(0,r.jsxs)("td",{className:"py-3 px-4 text-sm text-haven-text-secondary",children:[t.premium_months," months"]}),(0,r.jsx)("td",{className:"py-3 px-4",children:v(t.status,t.is_activated)}),(0,r.jsxs)("td",{className:"py-3 px-4 text-sm text-white font-medium text-right",children:["$",t.amount_charged.toFixed(2)]}),(0,r.jsx)("td",{className:"py-3 px-4 text-right",children:(0,r.jsx)("button",{onClick:()=>e.push("/dashboard/gifts/".concat(t.id)),className:"text-sm text-haven-primary hover:text-haven-primary/80",children:"View Details"})})]},t.id))})]})})}),x&&(0,r.jsx)(l,{onClose:()=>p(!1),onSuccess:()=>{p(!1),f()}})]})}function l(e){let{onClose:t,onSuccess:s}=e,[n,o]=(0,a.useState)({homebuyer_name:"",homebuyer_email:"",homebuyer_phone:"",home_address:"",closing_date:"",premium_months:6,custom_message:""}),[l,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(""),h=async e=>{e.preventDefault(),c(!0),u("");try{let e=await (0,i.x1)("/api/v1/partners/gifts",{method:"POST",body:n});e.success?s():u(e.message||"Failed to create gift")}catch(e){u(e.message||"An error occurred. Please try again.")}finally{c(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-haven-surface border border-haven-border rounded-xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-white",children:"Create Closing Gift"}),(0,r.jsx)("button",{onClick:t,className:"text-haven-text-tertiary hover:text-white",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),d&&(0,r.jsx)("div",{className:"mb-4 bg-haven-error/10 border border-haven-error/30 rounded-lg px-4 py-3 text-sm text-haven-error",children:d}),(0,r.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-haven-text-secondary mb-1.5",children:"Homebuyer Name *"}),(0,r.jsx)("input",{type:"text",required:!0,value:n.homebuyer_name,onChange:e=>o({...n,homebuyer_name:e.target.value}),className:"input-field"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-haven-text-secondary mb-1.5",children:"Email *"}),(0,r.jsx)("input",{type:"email",required:!0,value:n.homebuyer_email,onChange:e=>o({...n,homebuyer_email:e.target.value}),className:"input-field"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-haven-text-secondary mb-1.5",children:"Phone"}),(0,r.jsx)("input",{type:"tel",value:n.homebuyer_phone,onChange:e=>o({...n,homebuyer_phone:e.target.value}),className:"input-field"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-haven-text-secondary mb-1.5",children:"Home Address"}),(0,r.jsx)("input",{type:"text",value:n.home_address,onChange:e=>o({...n,home_address:e.target.value}),className:"input-field"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-haven-text-secondary mb-1.5",children:"Closing Date"}),(0,r.jsx)("input",{type:"date",value:n.closing_date,onChange:e=>o({...n,closing_date:e.target.value}),className:"input-field"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-haven-text-secondary mb-1.5",children:"Premium Months"}),(0,r.jsxs)("select",{value:n.premium_months,onChange:e=>o({...n,premium_months:Number(e.target.value)}),className:"input-field",children:[(0,r.jsx)("option",{value:3,children:"3 months"}),(0,r.jsx)("option",{value:6,children:"6 months"}),(0,r.jsx)("option",{value:12,children:"12 months"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-haven-text-secondary mb-1.5",children:"Custom Message"}),(0,r.jsx)("textarea",{value:n.custom_message,onChange:e=>o({...n,custom_message:e.target.value}),rows:3,placeholder:"Welcome to your new home! I'm excited to share this tool...",className:"input-field"})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,r.jsx)("button",{type:"button",onClick:t,className:"btn-secondary flex-1",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:l,className:"btn-primary flex-1",children:l?"Creating...":"Create Gift"})]})]})]})})}},71837:function(e,t,s){"use strict";s.d(t,{kS:function(){return i},x1:function(){return a}});let r=s(40257).env.NEXT_PUBLIC_API_URL||"";async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:s="GET",body:a,headers:i={}}=t,o={method:s,credentials:"include",headers:{"Content-Type":"application/json",...i}};a&&"GET"!==s&&(o.body=JSON.stringify(a));let l=e.startsWith("http")?e:"".concat(r).concat(e),c=await fetch(l,o);if(!c.ok){let e=await c.json().catch(()=>({}));throw new n(e.message||e.error||"Request failed with status ".concat(c.status),c.status)}return c.json()}class n extends Error{constructor(e,t){super(e),this.status=t,this.name="ApiError"}}async function i(){await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),window.location.href="/login"}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=60237)}),_N_E=e.O()}]);