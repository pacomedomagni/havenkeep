"use strict";(()=>{var e={};e.id=716,e.ids=[716],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},22993:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>x,requestAsyncStorage:()=>h,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f});var a={};r.r(a),r.d(a,{POST:()=>p});var n=r(49303),o=r(88716),s=r(60670),i=r(71615),u=r(87070),c=r(95456);let l=process.env.API_URL||"http://localhost:3000";async function p(){let e=await (0,i.cookies)(),t=e.get(c.wr)?.value,r=e.get(c.dj)?.value;if(r)try{await fetch(`${l}/api/v1/auth/logout`,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},body:JSON.stringify({refreshToken:r})})}catch{}return(0,c.Wx)(e),u.NextResponse.json({success:!0})}let d=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/logout/route",pathname:"/api/auth/logout",filename:"route",bundlePath:"app/api/auth/logout/route"},resolvedPagePath:"/Users/pacomedomagni/Projects/havenkeep/apps/partner-dashboard/src/app/api/auth/logout/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:f,serverHooks:g}=d,m="/api/auth/logout/route";function x(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}},95456:(e,t,r)=>{r.d(t,{D6:()=>h,Wx:()=>d,dj:()=>i,kF:()=>p,wr:()=>s});var a=r(71615),n=r(58585);let o=process.env.API_URL||"http://localhost:3000",s="hk_access_token",i="hk_refresh_token";async function u(){let e=await (0,a.cookies)(),t=e.get(s)?.value,r=e.get(i)?.value;return t&&r?{accessToken:t,refreshToken:r}:null}async function c(){let e=await u();if(!e)return null;let t=function(e){try{let t=e.split(".");if(3!==t.length)return null;return JSON.parse(Buffer.from(t[1],"base64url").toString())}catch{return null}}(e.accessToken);if(!t)return null;try{let t=await fetch(`${o}/api/v1/admin/me`,{headers:{Authorization:`Bearer ${e.accessToken}`,"Content-Type":"application/json"},cache:"no-store"});if(t.ok){let e=await t.json();return{id:e.user.id,email:e.user.email,plan:e.user.plan,isAdmin:e.user.isAdmin,isPartner:e.user.isPartner??!1}}}catch{}return{id:t.userId,email:t.email,plan:"free",isAdmin:!1,isPartner:!1}}async function l(){let e=await c();return e||(0,n.redirect)("/login"),e}async function p(){let e=await l();return e.isAdmin||(0,n.redirect)("/unauthorized"),e}function d(e){e.delete(s),e.delete(i)}async function h(e,t={}){let r=await u(),{method:a="GET",body:n,headers:s={}}=t,i={method:a,headers:{"Content-Type":"application/json",...r?{Authorization:`Bearer ${r.accessToken}`}:{},...s},cache:"no-store"};n&&"GET"!==a&&(i.body=JSON.stringify(n));let c=`${o}${e}`,l=await fetch(c,i);if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||`API request failed with status ${l.status}`)}return l.json()}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,54,972],()=>r(22993));module.exports=a})();